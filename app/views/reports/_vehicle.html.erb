<div class="card">
	<div class="card-body">

<table class="table table-bordered table-responsive">
	<thead>
		<tr>
			<th scope="col">Vehicle Number</th>
			<th scope="col">Status</th>
			<th scope="col">Mileage</th>
			<th scope="col">Location</th>
			<th scope="col">Open Work Orders</th>
			<th scope="col">Near Service - Miles Until:</th>
			<th scope="col">Services Required</th>
		</tr>
	</thead>
	<tbody>
      <% vehicle.order(vehicle_category_id: :asc).each do |vehicle| %>
        <tr>
          <th scope="row"><%= vehicle.car_id %></th>
  		  <td><%= vehicle.vehicle_status %></td>
          <td><%= vehicle.mileage %></td>
          <td><%= vehicle.location.locale %></td>
          <td><% vehicle.requests.where(tracker_id: @set_new && @set_progress).limit(3).each do |request| %>
  		  		<%= link_to request.number, request, method: :get, class: "badge badge-primary" %>
  				<%= request.tracker.track%>
  				<% end %></td>
          <td><% if vehicle.near_service == true %>
			 	<ul style="list-style-type:none;padding: 0;margin: 0;">
					<% if vehicle.requests.where(program_id: @set_a_service.id, tracker_id: @set_completed.id) != [] %>
					<li> A-Service: - <%= (@set_a_service.interval - (vehicle.mileage - vehicle.requests.where(program_id: @set_a_service.id, tracker_id: @set_completed.id).last.request_mileage))%> Miles </li> <% end %>
			     <%  if vehicle.requests.where(program_id: @set_shock_service.id, tracker_id: @set_completed.id) != [] %> 
				<li>Shock Service: - <%= (@set_shock_service.interval - (vehicle.mileage - vehicle.requests.where(program_id: @set_shock_service.id, tracker_id: @set_completed.id).last.request_mileage)) %> Miles</li>
				<% end %>
			      <% if vehicle.requests.where(program_id: @set_air_filter_service.id, tracker_id: @set_completed.id) != [] %>
					<li>Air Filter Change: - <%= (@set_air_filter_service.interval - (vehicle.mileage - vehicle.requests.where(program_id: @set_air_filter_service.id, tracker_id: @set_completed.id).last.request_mileage))%> Miles</li><% end %>
					<% end %>
				</ul>
			 </td>
  		  <td>
  			<% if vehicle.a_service == true %>
           A-Service 
  			  <% end %>
         <% if vehicle.shock_service == true  %>
          Shock-Service 
  			 <% end %>
  			 <% if vehicle.air_filter_service == true %>
  			Air Filter Service 
          <% end %>
  		  <% if vehicle.repair_needed == true %>
  		  Repairs In Progress
  		  <% end %>
		  <% if vehicle.defect == true %>
		  Defect Reported
		  <%  vehicle.requests.where(program_id: @set_defects.id, tracker_id: @set_new.id).each do |request|%>
		 		<br class="d-flex justify-content-end">&nbsp;&nbsp;&nbsp;&nbsp;<strong>Description:</strong> <%= request.description %>
		 		<% end %>
		  <% end %>
  	 </td>
	</tr>
	<% end %>
	</tbody>
</table>

</div>
</div>
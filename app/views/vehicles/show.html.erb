<div class="card mt-3">
  <div class="card-header">
    <h2 class="text-center">Vehicle:
    <%= @vehicle.car_id %> 
    <% if @vehicle.vehicle_status == "Sold"%>
      <span class="badge badge-warning badge-lg">
	    SOLD
      </span>
    <% end %>
    </h2>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-sm-6">
        <div class="row">
		  <div class="col-md-5">
            <strong>Vehicle category:</strong>
	      </div>
		  <div class="col-md-7">
            <%= @vehicle.veh_category%>
          </div>
        </div>
        <div class="row">
		  <div class="col-md-5">
            <strong>Location:</strong>
	      </div>
		  <div class="col-md-7">
            <%= @vehicle.location%>
          </div>
        </div>
        <div class="row">
		  <div class="col-md-5">
            <strong>Manufacturer:</strong>
	      </div>
		  <div class="col-md-7">
            <%= @vehicle.manufacturer %>
          </div>
        </div>
		<% if @vehicle.vehicle_status != "Sold"%>
        <div class="row">
		  <div class="col-md-5">
            <strong>Status:</strong>
	      </div>
		  <div class="col-md-7">
             <%= @vehicle.vehicle_status %>
          </div>
        </div>
        <% end %>
        <div class="row">
		  <div class="col-md-5">
            <strong>Vin number:</strong>
	      </div>
		  <div class="col-md-7">
            <%= @vehicle.vin_number %>
          </div>
        </div>
        <div class="row">
		  <div class="col-md-5">
            <strong>Registration date:</strong>
	      </div>
		  <div class="col-md-7">
           <%= @vehicle.registration_date %>
          </div>
        </div>
        <div class="row">
		  <div class="col-md-5">
            <strong>Plate number:</strong>
	      </div>
		  <div class="col-md-7">
           <%= @vehicle.plate_number %>
          </div>
        </div>
        <div class="row">
		  <div class="col-md-5">
            <strong>Current Mileage:</strong>
	      </div>
		  <div class="col-md-7">
           <%= @vehicle.mileage %>
          </div>
        </div>
		<% if @vehicle.vehicle_status == "Sold"%>
        <div class="row">
		  <div class="col-md-5">
            <strong>Date Sold:</strong>
	      </div>
		  <div class="col-md-7">
           <%= @vehicle.sale_date%>
          </div>
        </div>
        <div class="row">
		  <div class="col-md-5">
            <strong>Sold To:</strong>
	      </div>
		  <div class="col-md-7">
           <%= @vehicle.purchaser%>
          </div>
        </div>
		<% end %>	
        <% if @vehicle.high_use == true %>
		<p>
          <h4 style="color: green;">High Use </h4>
		</p>
        <% end %>
    </div>

<% if @vehicle.vehicle_status != "Sold"%>
<div class="col-sm-6">
	<div class="container d-flex justify-content-between align-items-center">
		<strong style="color:red;">Service:</strong>
		<strong style="color:red;">Mileage Until:</strong>
		<strong style="color:red;">Date Completed:</strong>
	</div>
	<ul class="list-group mt-2">
		
	<li class="list-group-item d-flex justify-content-between align-items-center"><strong>A-Service:</strong>
	
	<% if @vehicle.a_service == nil %>
	No Data
	<% elsif @vehicle.a_service %>
			<strong style="color: red;">NEEDS SERVICE</strong>
			<% else %>
	<span class="badge badge-success"><%= sprintf('%.2f', @vehicle.near_a_service_mileage) %></span>
	
	<% unless @vehicle.requests.where(program_id: @set_a_service.id).empty? %>
	<% if  @vehicle.requests.where(program_id: @set_a_service.id).last.completed_date != nil %>
	<span> <%= link_to "#{@vehicle.requests.where(program_id: @set_a_service.id).last.completed_date.strftime('%D')}", request_path(@vehicle.requests.where(program_id: @set_a_service.id).last), class: "badge badge-primary" %></span>
	
	<% end %>
	<% else %>
	None &nbsp&nbsp&nbsp&nbsp
	<% end %>
	<% end%></li>
	<li class="list-group-item d-flex justify-content-between align-items-center"><strong>Shock Service:</strong>
		<% if @vehicle.shock_service == nil %>
		No Data
		<% elsif @vehicle.shock_service %>
		<strong style="color:red;">NEEDS SERVICE</strong>
		<% else %>
	<span class="badge badge-success"><%= sprintf('%.2f', @vehicle.near_shock_service_mileage)  %> </span>
	<% unless @vehicle.requests.where(program_id: @set_shock_service.id).empty? %>
	<% if @vehicle.requests.where(program_id: @set_shock_service.id).last.completed_date != nil %>
	<span> <%= link_to "#{@vehicle.requests.where(program_id: @set_shock_service.id).last.completed_date.strftime('%D')}", request_path(@vehicle.requests.where(program_id: @set_shock_service.id).last), class: "badge badge-primary" %></span>
	
	<% end %>
	<% else %>
	&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp None 
	<% end %>
		<% end %>
</li>
	<li class="list-group-item d-flex justify-content-between align-items-center"><strong>Air Filter Service:</strong>
		<% if @vehicle.air_filter_service == nil %>
		No Data
		<% elsif @vehicle.air_filter_service %>
		<strong style="color: red;">NEEDS SERVICE</strong>
		<% else %>
	<span class="badge badge-success"><%= sprintf('%.2f', @vehicle.near_air_filter_service_mileage)  %></span>
	<% unless @vehicle.requests.where(program_id: @set_air_filter_service.id).empty? %>
	<% if @vehicle.requests.where(program_id: @set_air_filter_service.id).last.completed_date != nil %>
	<span> <%= link_to "#{@vehicle.requests.where(program_id: @set_air_filter_service.id).last.completed_date.strftime('%D')}", request_path(@vehicle.requests.where(program_id: @set_air_filter_service.id).last), class: "badge badge-primary"%></span>
	
	<% end %>
	<% else %>
	&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp None
	<% end %>
</li>
	<% end %>
	
	<li class="list-group-item"><strong>Repairs:</strong>
		<% if @vehicle.repair_needed == nil %>
		No Data
		<% elsif @vehicle.repair_needed == true%>
		<span style="color: red;"><i class="fa fa-wrench" aria-hidden="true"> &nbsp Repairs-In-Progress</i></span>
		<% else %>
		No Repairs Needed
		<% end %>
	</li>
	
	<li class="list-group-item"><strong>Tour Car Prep:</strong>
		<% if @vehicle.prep == nil %>
		No Data
		<% elsif @vehicle.prep == true%>
		<span style="color: red;"><i class="fa fa-wrench" aria-hidden="true"> &nbsp Preparation-Progress</i></span>
		<% else %>
		No Repairs Needed
		<% end %>
	</li>
	
	<li class="list-group-item"><strong>Defects:</strong>
		<% if @vehicle.defect == nil %>
		No Data
		<% elsif @vehicle.defect == true %>
		Defect Reported <%  @vehicle.requests.where(program_id: @set_defects.id, tracker_id: @set_new.id).each do |request|%>
		<br class="d-flex justify-content-end">&nbsp;&nbsp;&nbsp;&nbsp;<strong>Description:</strong> <%= request.description %>
		<% end %>
		<% else %>
		No Defects Reported
		<% end %>
	</li>
		
</ul>
</p>
<strong> Last Vehicle Mileage for: </strong>
<ul class="list-group mt-2">
	
	<li class="list-group-item d-flex justify-content-between align-items-center"> 
		<strong>A-Service  </strong>
		<% if @vehicle.last_a_service != nil%>
		<span class="badge badge-success"> 
		<%= sprintf('%.2f', @vehicle.last_a_service) %>
		</span> 
		<% end %>
	
	</li>
	<li class="list-group-item d-flex justify-content-between align-items-center"> 
		<strong>Shock Service </strong>
		<% if @vehicle.last_shock_service != nil %>
		<span class="badge badge-success"> 
		<%=sprintf('%.2f', @vehicle.last_shock_service)%>
		</span> 
	<% end %>
	</li>
	<li class="list-group-item d-flex justify-content-between align-items-center"> 
		<strong>Air Filter Change Service</strong>
		<% if @vehicle.last_air_filter_service != nil%>
		<span class="badge badge-success"> 
		<%= sprintf('%.2f', @vehicle.last_air_filter_service) %>
		</span> 
	<% end %>
	</li>
</ul>
</div>
</div>
<% end %>
<% if @vehicle.notes != nil%>

<div class="col-md-6">
<br \>
<div style="border: solid black 2px;border-radius: 6px 6px 6px 6px;padding: 20px 20px 20px 20px">
	<strong class="text-align: center;">Notes</strong>
	<br \>
	<%= @vehicle.notes%>
</div>
</div>
</div>
<% end %>



<div class="card-footer d-flex justify-content-between align-items-center">

<span>
<%= link_to 'Edit', edit_vehicle_path(@vehicle), class: "btn btn-info" %> &nbsp
<%= link_to 'Back', vehicles_path, class: "btn btn-warning" %></span>
<span> <%= link_to 'Vehicle Mileage Report', vehicle_mileage_vehicles_path(id: @vehicle.id), class: "btn btn-warning"%></span>
 	<strong>Download:
 	  <%= link_to "PDF", vehicle_path(@vehicle, params.merge(format: "pdf").permit!), class: "btn btn-info" %> </strong>

</div>
</div>

<div class="card mt-4">
	<div class="card-header">
		<h3 class="text-center"><%= @vehicle.car_id %> Maintenance History </h3>
	</div>
	<div class="card-body">
	<% if @vehicle.requests != []%>
	<ul class="list-group">
		<li class="list-group-item">
	<div class="row">
		<div class="col-md-3">
			<strong> ID </strong>
		</div>
		<div class="col-md-3">
			<strong> Status </strong>
		</div>
		<div class="col-md-3">
			<strong> Description </strong>
		</div>
		<div class="col-md-3">
			<strong> Completed Date </strong>
		</div>
	</div>
</li>
	
	<% @vehicle.requests.each do |work_order|%>
	<li class="list-group-item">
		<div class="row">
		<div class="col-md-3"> <%= link_to work_order.id, request_path(work_order), class: "badge badge-primary"%> </div>
		<div class="col-md-3"><%= work_order.status %> </div>
		<div class="col-md-3"><%= work_order.description%> </div>
		<div class="col-md-3" style="color: green "> <%= work_order.completed_date%></div>
	</div>
	</li>
	
	<% end %>
</ul>
	<% end %>
	
	</div>
</div>
